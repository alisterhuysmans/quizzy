(function(){"use strict";var e={702:function(e,t,s){var n=s(751),r=s(641);const i={class:"main-content"};function o(e,t,s,n,o,u){const a=(0,r.g2)("AppHeader"),c=(0,r.g2)("quiz-home"),l=(0,r.g2)("quiz-question"),h=(0,r.g2)("quiz-result"),d=(0,r.g2)("AppFooter");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(a,{title:"Quizzy"}),(0,r.Lk)("main",i,["quizHome"===o.currentPage?((0,r.uX)(),(0,r.Wv)(c,{key:0,onChangePage:u.handleChangePage},null,8,["onChangePage"])):(0,r.Q3)("",!0),"quizQuestion"===o.currentPage?((0,r.uX)(),(0,r.Wv)(l,{key:1,categoryId:o.currentCategoryId,onChangePage:u.handleChangePage},null,8,["categoryId","onChangePage"])):(0,r.Q3)("",!0),"quizResult"===o.currentPage?((0,r.uX)(),(0,r.Wv)(h,{key:2,score:o.score,total:o.totalQuestions,totalPointsPossible:o.totalPointsPossible,onChangePage:u.handleChangePage},null,8,["score","total","totalPointsPossible","onChangePage"])):(0,r.Q3)("",!0)]),(0,r.bF)(d)],64)}var u=s(33);const a={class:"logo-quizzy",href:"#"};function c(e,t,s,n,i,o){return(0,r.uX)(),(0,r.CE)("header",null,[(0,r.Lk)("a",a,[(0,r.Lk)("h1",null,(0,u.v_)(s.title),1)])])}var l={name:"AppHeader",props:{title:{type:String,required:!0}}},h=s(262);const d=(0,h.A)(l,[["render",c]]);var g=d;function p(e,t,s,n,i,o){return(0,r.uX)(),(0,r.CE)("footer",null,[(0,r.Lk)("p",null,"© "+(0,u.v_)(i.currentYear)+" Quizzy",1)])}var m={name:"AppFooter",data(){return{currentYear:(new Date).getFullYear()}}};const f=(0,h.A)(m,[["render",p]]);var b=f;const v={class:"quiz-home"},y={key:0,class:"page-title"},C={key:1,class:"error-message"},k=(0,r.Lk)("p",null,"Connection perdue avec l'API.",-1),Q={key:2},P={class:"cat-container"},z=["onClick"];function w(e,t,s,n,i,o){return(0,r.uX)(),(0,r.CE)("div",v,[i.errorMessage?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("h2",y," Choisissez une catégorie ")),i.errorMessage?((0,r.uX)(),(0,r.CE)("div",C,[k,(0,r.eW)(" "+(0,u.v_)(i.errorMessage),1)])):((0,r.uX)(),(0,r.CE)("div",Q,[(0,r.Lk)("div",P,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.categories,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id},[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t=>o.selectCategory(e.id)},(0,u.v_)(e.title),9,z)])))),128))])]))])}var L={data(){return{categories:[],errorMessage:null}},mounted(){this.fetchCategories()},methods:{fetchCategories(){fetch("https://quizz-musical-backend.airdev.be/api/categories").then((e=>{if(!e.ok)throw new Error("Server Error");return e.json()})).then((e=>{this.categories=e,this.errorMessage=null})).catch((e=>{console.error("Error:",e),this.errorMessage="An error occurred while fetching categories"}))},selectCategory(e){this.$emit("changePage","quizQuestion",e)}}};const q=(0,h.A)(L,[["render",w]]);var A=q;const E={class:"quiz-question-container"},I={key:0},X=(0,r.Lk)("p",null,"Chargement des questions...",-1),M=[X],T={key:1},x={class:"timer"},_={class:"quiz-question"},R={key:0},O=["src"],j={key:1},F={key:2,class:"audio-choices-container"},H=["onClick","disabled"],N={key:1},$=["innerHTML"],V={class:"input-container"},W={class:"actions"},K=["disabled"],U=["disabled"],Y={key:2,class:"feedback"};function B(e,t,s,i,o,a){return(0,r.uX)(),(0,r.CE)("div",E,[a.currentQuestion?((0,r.uX)(),(0,r.CE)("div",T,[(0,r.Lk)("p",x,"Temps restant : "+(0,u.v_)(o.timeLeft)+" sec",1),(0,r.Lk)("h2",_,(0,u.v_)(a.currentQuestionNumber)+" - "+(0,u.v_)(a.currentQuestion.title),1),2===a.currentQuestion.category_id?((0,r.uX)(),(0,r.CE)("div",R,[o.isAudioPlaying?((0,r.uX)(),(0,r.CE)("audio",{key:0,ref:"audioPlayer",controls:"",src:a.currentQuestion.content.sound_url},null,8,O)):(0,r.Q3)("",!0),!o.isAudioPlaying&&o.audioCountdown>0?((0,r.uX)(),(0,r.CE)("p",j," Commence dans "+(0,u.v_)(o.audioCountdown),1)):(0,r.Q3)("",!0),a.currentQuestion.content.answers?((0,r.uX)(),(0,r.CE)("div",F,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.currentQuestion.content.answers,(e=>((0,r.uX)(),(0,r.CE)("button",{class:"btn btn-primary",key:e,onClick:t=>a.submitAnswer(e),disabled:o.submitted},(0,u.v_)(e),9,H)))),128))])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),1===a.currentQuestion.category_id&&a.currentQuestion.content.lyrics?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.Lk)("p",{class:"lyrics",innerHTML:a.formatLyrics(a.currentQuestion.content.lyrics)},null,8,$),(0,r.Lk)("div",V,[(0,r.bo)((0,r.Lk)("input",{class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.userResponse=e),placeholder:"Votre réponse..."},null,512),[[n.Jo,o.userResponse]]),(0,r.Lk)("div",W,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>a.submitLyricsAnswer&&a.submitLyricsAnswer(...e)),disabled:o.submitted}," Valider ",8,K),(0,r.Lk)("button",{class:"btn btn-secondary",onClick:t[2]||(t[2]=(...e)=>a.skipQuestion&&a.skipQuestion(...e)),disabled:o.submitted}," Passer ",8,U)])])])):(0,r.Q3)("",!0),o.feedbackMessage?((0,r.uX)(),(0,r.CE)("div",Y,(0,u.v_)(o.feedbackMessage),1)):(0,r.Q3)("",!0)])):((0,r.uX)(),(0,r.CE)("div",I,M))])}var S={props:["categoryId"],data(){return{questions:[],currentQuestionIndex:0,score:0,totalPointsPossible:0,userResponse:"",feedbackMessage:"",timeLeft:30,audioCountdown:3,isAudioPlaying:!1,timer:null,submitted:!1}},computed:{currentQuestion(){return this.questions.length>0?this.questions[this.currentQuestionIndex]:null},currentQuestionNumber(){return this.currentQuestionIndex+1}},mounted(){this.fetchQuestions(),this.startAudioCountdown()},watch:{currentQuestionIndex(e,t){e!==t&&(this.startCountdown(),this.startAudioCountdown())}},beforeUnmount(){this.timer&&clearInterval(this.timer)},methods:{startAudioCountdown(){this.audioCountdown=3,this.isAudioPlaying=!1;let e=setInterval((()=>{this.audioCountdown>1?this.audioCountdown-=1:(clearInterval(e),this.playAudio())}),1e3)},playAudio(){this.isAudioPlaying=!0,this.$nextTick((()=>{const e=this.$refs.audioPlayer;e&&e.play().catch((e=>{console.error("Error playing audio:",e)}))}))},startCountdown(){this.timer&&clearInterval(this.timer),this.timeLeft=30,this.timer=setInterval((()=>{this.timeLeft>0?this.timeLeft--:this.handleTimeOut()}),1e3)},handleTimeOut(){clearInterval(this.timer),this.feedbackMessage="Temps écoulé !",setTimeout((()=>{this.moveToNextQuestion()}),2e3)},fetchQuestions(){fetch(`https://quizz-musical-backend.airdev.be/api/questions?category_id=${this.categoryId}`).then((e=>e.json())).then((e=>{this.questions=this.shuffleArray(e),this.calculateTotalPoints(),this.startCountdown()})).catch((e=>console.error("Erreur lors de la récupération des questions:",e)))},shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},calculateTotalPoints(){this.totalPointsPossible=this.questions.reduce(((e,t)=>e+t.points),0)},formatLyrics(e){return e.replace(/<br\s*\/?>/gi,"\n")},submitLyricsAnswer(){if(!this.userResponse||!this.currentQuestion.answer||this.submitted)return this.feedbackMessage="Une erreur est survenue. Veuillez réessayer.",void clearInterval(this.timer);const e=this.compareLyricsAnswer(this.userResponse,this.currentQuestion.answer);this.feedbackMessage=e?"Bonne réponse !":"Mauvaise réponse !",e&&(this.score+=this.currentQuestion.points),setTimeout((()=>{this.moveToNextQuestion()}),2e3),this.submitted=!0},submitAnswer(e){if(2===this.currentQuestion.category_id){const t=this.compareResponses(e,this.currentQuestion.answer);this.feedbackMessage=t?"Bonne réponse !":"Mauvaise réponse !",clearInterval(this.timer),t&&(this.score+=this.currentQuestion.points)}setTimeout((()=>{this.moveToNextQuestion()}),2e3),this.submitted=!0},compareLyricsAnswer(e,t){const s=e.toLowerCase().trim(),n=t.toLowerCase().trim(),r=s.split(/\s+/),i=n.split(/\s+/);if(r.length!==i.length)return!1;for(let o=0;o<r.length;o++){const e=r[o],t=i[o];if(t.length<4&&e!==t)return!1;if(t.length>=4){const s=Math.abs(e.length-t.length);if(s>1)return!1;let n=Math.min(e.length,t.length);for(let r=0;r<n;r++)if(e[r]!==t[r])return!1}}return!0},compareResponses(e,t){const s=e.trim().toLowerCase(),n=t.trim().toLowerCase();return s.includes(n)||n.includes(s)},moveToNextQuestion(){this.userResponse="",this.feedbackMessage="",this.submitted=!1,this.currentQuestionIndex<this.questions.length-1?this.currentQuestionIndex++:this.endQuiz()},endQuiz(){this.$emit("changePage","quizResult",{score:this.score,total:this.questions.length,totalPointsPossible:this.totalPointsPossible})},skipQuestion(){this.moveToNextQuestion()}}};const D=(0,h.A)(S,[["render",B]]);var J=D;const G={class:"quiz-result"},Z=(0,r.Lk)("h1",{class:"page-title"},"Résultats du Quiz",-1),ee={class:"result-actions"};function te(e,t,s,n,i,o){return(0,r.uX)(),(0,r.CE)("div",G,[Z,(0,r.Lk)("p",null,"Votre score est : "+(0,u.v_)(s.score)+" sur "+(0,u.v_)(s.totalPointsPossible),1),(0,r.Lk)("div",ee,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("changePage","quizQuestion",s.currentCategoryId))}," Rejouer "),(0,r.Lk)("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=t=>e.$emit("changePage","quizHome"))}," Choisir une autre catégorie ")])])}var se={props:["score","total","totalPointsPossible","currentCategoryId"]};const ne=(0,h.A)(se,[["render",te]]);var re=ne,ie={name:"App",components:{AppHeader:g,AppFooter:b,QuizHome:A,QuizQuestion:J,QuizResult:re},data(){return{currentPage:"quizHome",currentCategoryId:null,score:0,totalQuestions:0,totalPointsPossible:0}},methods:{handleChangePage(e,t=null){"quizResult"===e&&"object"===typeof t?(this.score=t.score,this.totalQuestions=t.total,this.totalPointsPossible=t.totalPointsPossible):"quizQuestion"===e&&"number"===typeof t&&(this.currentCategoryId=t,this.score=0,this.totalQuestions=0),this.currentPage=e,"quizHome"===e&&(this.currentCategoryId=null)},handleQuizEnd(e){this.score=e.score,this.totalQuestions=e.total,this.totalPointsPossible=e.totalPointsPossible,this.currentPage="quizResult"}}};const oe=(0,h.A)(ie,[["render",o]]);var ue=oe;(0,n.Ef)(ue).mount("#app")}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,n,r,i){if(!n){var o=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],i=e[l][2];for(var u=!0,a=0;a<n.length;a++)(!1&i||o>=i)&&Object.keys(s.O).every((function(e){return s.O[e](n[a])}))?n.splice(a--,1):(u=!1,i<o&&(o=i));if(u){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,r,i]}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,o=n[0],u=n[1],a=n[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in u)s.o(u,r)&&(s.m[r]=u[r]);if(a)var l=a(s)}for(t&&t(n);c<o.length;c++)i=o[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(l)},n=self["webpackChunkQuizzy"]=self["webpackChunkQuizzy"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(702)}));n=s.O(n)})();
//# sourceMappingURL=app.454a1257.js.map